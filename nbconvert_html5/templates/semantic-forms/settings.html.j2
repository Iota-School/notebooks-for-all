<dialog id="nb-settings">
    <h1>Settings</h1>
    <form method="dialog">
        <button type="submit">Close</button>
    </form>
    <fieldset id="nb-color-scheme-radio">
        <legend>color scheme</legend>
        <label aria-hidden="true" for="nb-color-theme-radio">color scheme</label>
        <label><input value="light" name="color-scheme" type="radio" checked> light mode</label>
        <label><input value="dark" name="color-scheme" type="radio"> dark mode</label>
    </fieldset>
    <fieldset id="nb-table-role-radio">
        <legend>cell navigation</legend>
        <label aria-hidden="true" for="nb-table-role-radio">cell navigation</label>
        <label><input value="list" name="table-role" type="radio" checked> list</label>
        <label><input value="table" name="table-role" type="radio"> table</label>
        <label><input value="region" name="table-role" type="radio"> landmark</label>
        <label><input value="grid" name="table-role" type="radio" disabled> grid</label>
        <label><input value="treegrid" name="table-role" type="radio" disabled> treegrid</label>
        <label><input value="tree" name="table-role" type="radio" disabled> tree</label>
    </fieldset>
    <fieldset id="nb-table-font-group">
        <legend>font settings</legend>
        <label aria-hidden="true" for="nb-table-font-size-group">font size</label>
        <select name="font-size" id="nb-table-font-size-group">
            <option value="xx-small">xx-small</label>
            <option value="x-small">x-small</label>
            <option value="small">small</label>
            <option value="medium" selected>medium</label>
            <option value="large">large</label>
            <option value="x-large">x-large</label>
            <option value="xx-large">xx-large</label>
        </select>
        <style id="nb-font-size-style"></style>
        <fieldset id="nb-font-serif-radio">
            <legend>serif</legend>
            <label><input value="serif" name="font-family" type="radio" checked> serif</label>
            <label><input value="sans-serif" name="font-family" type="radio"> sans-serif</label>
        </fieldset>
        <style id="nb-font-family-style"></style>
        <span hidden id="nb-def-cell">cell</span>
    </fieldset>
</dialog>

{# these settings should be updated from query parameters #}

{% raw %}
<script>
    const SELECTORS = {
        "table": "table#cells",
        "body": "table#cells>tbody",
        "row": "table#cells>tbody>tr",
        "cell": "table#cells>tbody>tr>th,table#cells>tbody>tr>td",
    }, ROLES = {
        "list": {
            "table": "group",
            "body": "list",
            "row": "listitem",
            "cell": "none",
        }, "table": {
            "table": "table",
            "body": "rowgroup",
            "row": "row",
            "cell": "cell",
        }, "region": {
            "table": "group",
            "body": "group",
            "row": "region",
            "cell": "none",
        }, "generic": {
            "table": "group",
            "body": "none",
            "row": "none",
            "cell": "none",
        }
    };

    function toggleColorScheme() {
        document.getElementById(`nb-${event.target.value}-theme`).setAttribute("media", "all");
        let opposite = event.target.value == "dark" ? "light" : "dark"
        document.getElementById(`nb-${opposite}-theme`).setAttribute("media", "none");
        document.querySelector(`head > meta[name="color-scheme"]`).setAttribute("content", event.target.value);
    }
    document.querySelectorAll("#nb-color-scheme-radio>label>input").forEach(
        (x) => { x.addEventListener("change", toggleColorScheme) }
    )
    function toggleRole() {
        if (event.target.checked) {
            for (const [k, selector] of Object.entries(SELECTORS)) {
                document.querySelectorAll(selector).forEach(
                    (x) => { x.setAttribute("role", ROLES[event.target.value][k]) }
                )
            }
        }
    }
    document.querySelectorAll("#nb-table-role-radio>label>input").forEach(
        (x) => { x.addEventListener("change", toggleRole) }
    )
    function changeFont() {
        document.getElementById("nb-font-size-style").textContent = `:root {--nb-font-size: ${event.target.value};}`
    }
    document.querySelectorAll(`select[name="font-size"]`).forEach(
        (x) => { x.addEventListener("change", changeFont) }
    )

    function changeFontFamily() {
        document.getElementById("nb-font-size-style").textContent = `:root {font-family: ${event.target.value};}`
    }
    document.querySelectorAll(`[name="font-family"]`).forEach(
        (x) => { x.addEventListener("change", changeFontFamily) }
    )

</script>
{% endraw %}